<link rel="stylesheet" href="/client/styles/jquery/smoothness/jquery-ui-1.7.1.all.css?&iuqt=1">
<link rel="stylesheet" href="https://foundation.uc.edu/file/custom-content-parts/css/bb-custom-form_display.css" type="text/css" />

<div class="message-form container"></div>

<script src="/file/js/edq-validate.js" type="text/javascript"></script>

<script>
    //templates
    var BBCustomFormPage = 1;
    var BBCustomFormPages = 1;
    var $row = $('<div class="form-field-complex custom-form col-md-12"></div>');
    var $label = $('<label></label>');
    var $text = $('<p></p>');
    var $div = $('<div></div>');
    var $link = $('<a href="#">Test Link</a>');

    var $image = $('<img src="" >');
    var $cardTitle = $('<p class="large"></p>');

    // var $accordionText = $('<label class="tab-label large" data-aria-accordion-heading></label>');
    var $accordionText = $('<h3><button aria-expanded="true" class="Accordion-trigger" aria-controls="sect1" id="accordion1id"><span class="Accordion-title"><span class="Accordion-icon"></span></span></button></h3>');

    // var $accordionContent = $('<div class="tab-content" data-aria-accordion-panel><p></p></div>');
    var $accordionContent = $('<div id="sect1" role="region" aria-labelledby="accordion1id" class="Accordion-panel"></div>');

    var $byline = $('<div class="byline"></div>');
    var $bylineAuthorDiv = $('<div class="author"></div>');
    var $bylineName = $('<span class="name"></span>');
    var $bylinePhone = $('<span class="phone"></span>');
    var $bylineEmail = $('<span class="email"></span>');

    var $option = $('<option></option>');
    var $button = $('<button type="button" class="button-primary next btn btn-lg btn-block btn-primary"></button>');
    var $help = $('<small id="passwordHelpBlock" class="form-text text-muted"></small>');

    var $quotesource = $('<span></span>');

    var $page = $('<div class="form-page row"></div>');

    var $fieldtemplate = {};
    $fieldtemplate["heading1"] = $('<h1></h1>');
    $fieldtemplate["heading2"] = $('<h2></h2>');
    $fieldtemplate["heading3"] = $('<h3></h3>');

    $fieldtemplate["yes/no"] = $('<input type="checkbox" />');
    $fieldtemplate["text"] = $('<p></p>');
    $fieldtemplate["card"] = $('<div class="card"></div>');
    $fieldtemplate["hr"] = $('<hr>');
    $fieldtemplate["image"] = $('<div class="image"></div>');

    // $fieldtemplate["accordion"] = $('<div class="accordion" data-aria-accordion></div>');
    $fieldtemplate["accordion"] = $('<div id="accordionGroup" class="Accordion" data-allow-toggle>');

    $fieldtemplate["blockquote"] = $('<blockquote></blockquote>');
    $fieldtemplate["phone"] = $('<input type="tel" class="form-control phone" />');
    $fieldtemplate["email"] = $('<input type="email" class="form-control email" />');
    $fieldtemplate["date"] = $('<input type="text" class="form-control datepicker" placeholder="DD/MM/YYYY" />');
    $fieldtemplate["time"] = $('<input type="time" class="form-control" />');
    // $fieldtemplate["code table"] = $('<select class="form-control"></select>');
    $fieldtemplate["event category"] = $('<select class="event-category form-control"></select>');
    $fieldtemplate["address"] = $('<input type="text" class="form-control" />');
    $fieldtemplate["postcode"] = $('<input type="text" class="form-control" />');
    $fieldtemplate["suburb"] = $('<input type="text" class="form-control" />');
    $fieldtemplate["state"] = $('<select class="state form-control"></select>');

    var hasPageBreak = false;

    var EDQ = {};

    function initBBCustomForm(data) {
        /*
		if (!$('div[id$="_divComment"]').length) {
            console.error("Sorry, the comments field was not enabled.  Please edit the Interaction Form and ensure that the commment is available editable.");
            return false;
        } else {
            $('div[id$="_divComment"]').hide();
        } 
	  */
        var $form = $('.message-form');
        $form.children().not('.form-wrap').addClass("col-md-12");

        $form.prepend($page.clone().append($form.find('.form-wrap').siblings()));

        $('span.error:contains("required")').siblings('input,select').addClass('required');

        $.each(data.settings.items, function(i, item) {
          // console.log(item);
            if (item.type !== "page break") {
                if (item.type == "heading1") {
                    var $newRow = $row.clone()
                        .append($label.clone().attr('for', 'customField' + item.index).text())
                        .append($fieldtemplate[item.type].clone().text(item.question));
                } else if (item.type == "heading2") {
                    var $newRow = $row.clone()
                        .append($label.clone().attr('for', 'customField' + item.index).text())
                        .append($fieldtemplate[item.type].clone().text(item.question));
                } else if (item.type == "heading3") {
                    var $newRow = $row.clone()
                        .append($label.clone().attr('for', 'customField' + item.index).text())
                        .append($fieldtemplate[item.type].clone().text(item.question));
                } else if (item.type == "blockquote") {
                    var $newRow = $row.clone()
                        .append($label.clone().attr('for', 'customField' + item.index).text())
                        .append(($fieldtemplate[item.type].clone().text(item.quoteText)).append($text.clone().html("&mdash; " + item.quoteSource.trim())));
                } else if (item.type == "card") {
                    var $newRow = $row.clone()
                        .append(($fieldtemplate[item.type].clone()
                            .append($image.clone().attr("src", item.cardImgSrc.trim()))
                            .append($div.clone()
                                .append($cardTitle.clone().text(item.cardTitle.trim()))
                                .append($text.clone().text(item.cardText.trim()))
                                .append($link.clone().attr("href", item.cardLinkUrl.trim()).text(item.cardLinkText.trim()))
                            )
                        ));
                } else if (item.type == "image") {
                    var marginVals;
                    switch (item.imageAlign) {
                        case "left":
                            marginVals = "0 auto 0 0";
                            break;
                        case "center":
                            marginVals = "0 auto";
                            break;
                        case "right":
                            marginVals = "0 0 0 auto";
                    }
                    var $newRow = $row.clone().css('margin', marginVals)
                        .append(($fieldtemplate[item.type].clone()
                            .append($image.clone().attr("src", item.imageSrc.trim()))
                            .append($text.clone().text(item.imageCaption.trim()).css('text-align', 'center'))
                        ));
                } else if (item.type == "accordion") {
                    var $newRow = $row.clone()
                        .append(($fieldtemplate[item.type].clone()
                        	.append('<h3><buttton aria-expanded="false" class="Accordion-trigger" aria-controls="sect' + item.index + '" id="accordion' + item.index + 'id"><span class="Accordion-title">' + item.accordionText.trim() + '<span class="Accordion-icon"></span></span></button></h3>')
                            .append('<div id="sect' + item.index + '" role="region" aria-labelledby="accordion' + item.index + 'id" class="Accordion-panel" hidden>' + item.accordionContent.trim() + '</div>')
                        ));
                } else if (item.type == "formattedtext") {
                    var $newRow = $row.clone()
                        .append($div.clone().html(item.formattedText.trim()));
                } else if (item.type == "byline") {
                    var $newRow = $row.clone()
                        .append($byline.clone()
                            .append($bylineAuthorDiv.clone()
                                .append($bylineName.clone().html("By <strong>" + item.authorName.trim() + "</strong>"))
                                .append($bylineEmail.clone()
                                    .append($link.clone()
                                        .attr("href", "mailto:" + item.authorEmail.trim()).text("Email " + item.authorName.trim().split(" ")[0]))
                                )
                                .append($bylinePhone.clone().text(item.authorPhone.trim()))
                            )
                        );
                } else if (item.type == "hr") {
                    var $newRow = $row.clone().css('margin', '0 auto')
                        .append(($fieldtemplate[item.type].clone()));
                } else {
                    var $newRow = $row.clone()
                        .append($text.clone().text(item.question));
                    //.prepend($fieldtemplate[item.type].clone().attr('id', 'customField' + item.index).attr('name', 'customField' + item.index)));
                }


                if (item.help != null) {
                    if (item.help.trim().length > 0) {
                        $newRow.append($help.clone().text(item.help.trim()));
                    }
                }
                if (item.columns != null) {
                    $newRow.removeClass('col-md-12');
                    $newRow.addClass('col-md-' + item.columns);
                }
                if (item.required == "on") {
                    $newRow.find('input, select').addClass('required');
                    $newRow.children('label').append(' <abbr title="Field is required">*</abbr>');
                }
                if (item.maxLength != null) {
                    $newRow.find('input').attr('maxlength', item.maxLength);
                }
                if (item.type == "event category") {
                    $.each(data.settings.ddEventCategories, function(key, value) {
                        $newRow.find('select').append($option.clone().attr('value', key).text(value));
                    });
                }
                if (item.type == "code table" && item.codeTableMulti == "off") {
                    $.get("/WebAPI/CodeTable/" + item.codeTableID, function(data) {
                        if (item.required !== "on") {
                            $newRow.find('select').append($option.clone());
                        }
                        $.each(data, function() {
                            $newRow.find('select').append($option.clone().attr('value', this.Id).text(this.Description));
                        });
                    });
                }
                if (item.type == "state") {
                    $.get("/WebAPI/Country/" + item.countryID + "/State", function(data) {
                        if (item.required !== "on") {
                            $newRow.find('select').append($option.clone());
                        }
                        $.each(data, function() {
                            $newRow.find('select').attr('autocomplete', item.question).append($option.clone().attr('value', this.Id).text(this.Abbreviation));
                        });
                    });
                }
                if (item.linkAttr == "on") {
                    $('#' + $('#InteractionAdd').find('label').filter(function() {
                        return $(this).text().trim() == item.linkAttrLabel.trim();
                    }).first().attr('for')).first().closest('.form-field-complex').hide();

                    $(document).on('change input', '#customField' + item.index, function() {

                        if (item.type == "yes\/no") {

                            var value = $(this).is(":checked");
                            $('#' + $('#InteractionAdd').find('label').filter(function() {
                                return $(this).text().trim() == item.linkAttrLabel.trim();
                            }).first().attr('for')).attr('checked', value);

                        } else {

                            var value = $(this).val();
                            $('#' + $('#InteractionAdd').find('label').filter(function() {
                                return $(this).text().trim() == item.linkAttrLabel.trim();
                            }).first().attr('for')).val(value);
                        }

                    });

                }

                if (item.conditional == "on") {
                    $newRow.addClass('hide');

                    var target = data.settings.items.filter(obj => {
                        return obj.index === item.conditionalCompare
                    });

                    $(document).on('change input', '#customField' + target[0].index, function() {
                        if (item.conditionalOperator == "equals") {

                            //checkbox equal to
                            if (target[0].type == "yes\/no") {
                                if ((item.conditionalFields.checkbox == "on") == $(this).is(':checked')) {
                                    $('#customField' + item.index).closest('.custom-form').removeClass('hide');
                                } else {
                                    $('#customField' + item.index).val("").removeAttr('checked').trigger('change').closest('.custom-form').addClass('hide');
                                }
                            }
                            //codetable equal to
                            else if (target[0].type == "code table") {
                                if (item.conditionalFields.codetable == $(this).val()) {
                                    $('#customField' + item.index).closest('.custom-form').removeClass('hide');
                                } else {
                                    $('#customField' + item.index).val("").removeAttr('checked').trigger('change').closest('.custom-form').addClass('hide');
                                }
                            }
                            //codetable equal to
                            else if (target[0].type == "event category") {
                                if (item.conditionalFields.eventcategory == $(this).val()) {
                                    $('#customField' + item.index).closest('.custom-form').removeClass('hide');
                                } else {
                                    $('#customField' + item.index).val("").removeAttr('checked').trigger('change').closest('.custom-form').addClass('hide');
                                }
                            }
                            //other field (text, phone, email etc.)
                            else {
                                if (item.conditionalFields.textfield == $(this).val()) {

                                    $('#customField' + item.index).closest('.custom-form').removeClass('hide');
                                } else {

                                    $('#customField' + item.index).val("").removeAttr('checked').trigger('change').closest('.custom-form').addClass('hide');
                                }
                            }


                        }
                        if (item.conditionalOperator == "not") {
                            //checkbox not equal to
                            if (target[0].type == "yes\/no") {
                                if ((item.conditionalFields.checkbox == "on") != $(this).is(':checked')) {
                                    $('#customField' + item.index).closest('.custom-form').removeClass('hide');
                                } else {
                                    $('#customField' + item.index).val("").removeAttr('checked').trigger('change').closest('.custom-form').addClass('hide');
                                }
                            }
                            //codetable not equal to
                            else if (target[0].type == "code table") {
                                if (item.conditionalFields.codetable != $(this).val()) {
                                    $('#customField' + item.index).closest('.custom-form').show();
                                } else {
                                    $('#customField' + item.index).val("").removeAttr('checked').trigger('change').closest('.custom-form').addClass('hide');
                                }
                            }
                            //codetable not equal to
                            else if (target[0].type == "event category") {
                                if (item.conditionalFields.eventcategory != $(this).val()) {
                                    $('#customField' + item.index).closest('.custom-form').show();
                                } else {
                                    $('#customField' + item.index).val("").removeAttr('checked').trigger('change').closest('.custom-form').addClass('hide');
                                }
                            }
                            //other field (text, phone, email etc.)
                            else {
                                if (item.conditionalFields.textfield != $(this).val()) {
                                    $('#customField' + item.index).closest('.custom-form').show();
                                } else {
                                    $('#customField' + item.index).val("").removeAttr('checked').trigger('change').closest('.custom-form').addClass('hide');
                                }
                            }
                        }

                    });
                }

                $form.find('.form-page').last().append($newRow);

            } else {
                $page.clone().insertAfter($form.find('.form-page').last());
                BBCustomFormPages++;
                hasPageBreak = true;
            }

        });

        //trigger required checkboxes to set attribute value by default
        $('.custom-form select, .custom-form input[type="checkbox"]').trigger('change');

        if (!$('#btnSubmitProxy').length) {
            $('<button type="button" id="btnSubmitProxy" class="button-primary next btn btn-lg btn-block btn-primary half-right" onclick="BBCustomFormSubmit();" style="display: none;">' + $('#InteractionAdd .form-wrap input').attr('value') + '</button>').insertBefore('#InteractionAdd .form-wrap input')
            $('#InteractionAdd .form-wrap input').hide();

        }

        if (!hasPageBreak) {
            $('#btnSubmitProxy').show();
        }
        if (hasPageBreak) {
            $('<button type="button" id="btnPrev" class="btn-outline-primary prev btn btn-lg btn-block half-left" style="display: none;">' + data.settings.txtButtonPrev + '</button>').insertAfter($form.find('#btnSubmitProxy'));
            $('<button type="button" id="btnNext" class="btn-primary next btn btn-lg btn-block">' + data.settings.txtButtonNext + '</button>').prependTo($form.find('.form-wrap'));
            $('#btnSubmitProxy').addClass('half-right').hide();

            $form.find('.form-page').hide().first().show();

            $(document).on('click', '#btnNext', function() {

                if (jQuery.isFunction(jQuery.validator)) {
                    var valid = $('#form1').validate({
                        ignore: ":not(:visible)"
                    }).form();

                    $('#form1').find('label.error:hidden').remove();
                    $('#form1').find('.error:hidden').removeClass('error');

                    if (valid || $("#form1").find('.error:visible').length == 0) {
                        BBCustomFormPage++;

                        $form.find('.form-page:visible').hide().next().show();
                        $('div[id$="_acqIntro"]').hide();
                        $('#btnPrev').show();
                        $('#btnNext').addClass('half-right');
                        if (BBCustomFormPage == BBCustomFormPages) {
                            $('#btnSubmitProxy').show();
                            $('#btnNext').hide();
                        } else {
                            $('#btnSubmitProxy').hide();
                        }

                        if ($('.form-page:visible > div:visible').length == 0) {
                            $('#btnNext:visible').click();
                        }

                    }

                }

            });

            $(document).on('click', '#btnPrev', function() {
                BBCustomFormPage--;

                $form.find('.form-page:visible').hide();
                $('#btnNext').show();
                $('#btnSubmitProxy').hide();

                if (BBCustomFormPage <= 1) {

                    $('#btnNext').removeClass('half-right');
                    $form.find('.form-page').first().show();
                    $('div[id$="_acqIntro"]').show();
                    $('#btnPrev').hide();
                } else {
                    $form.find('.form-page').eq(BBCustomFormPage - 1).show();
                    $('#btnPrev').show();
                }

                if ($('.form-page:visible > div:visible').length == 0) {
                    $('#btnPrev:visible').click();
                }



            });


        } else {

        } //END PAGEBREAKS

        //MATRIX FOR EVENT CATEGORY ON LOAD
        RunMatrix($('.event-category').val(), data.settings.Matrix);

        $(document).on('change', '.event-category', function() {
            RunMatrix($(this).val(), data.settings.Matrix);
        });

        $('input.address_search').each(function() {
            $.each(this.attributes, function(i, attrib) {
                var name = attrib.name;
                var value = attrib.value;
                if (name == "data-map-address" || name == "data-map-suburb" || name == "data-map-state" || "data-map-suburb") {
                    $('#customField' + value).parents('.custom-form').hide();
                }
            });
        });


        $('.hasDatepicker').datepicker({
            onClose: function() {
                $(this).valid();
            }
        });


        //QAS
        // EDQ.current = 0;
        // EDQ.length = 0;
        // EDQ.limit = data.settings.txtLimit || 25;
        // EDQ.show = data.settings.txtShow || 4;
        // EDQ.country = "";
        // EDQ.term = "";
        // EDQ.results = "";
        // EDQ.resultscontainer = "";
        // EDQ.client = new EXP.DQ.Address.Client({
        //     token: data.settings.txtAPI
        // });
        // EDQ.enabledCountries = data.settings.ddCountries;
        // EDQ.countries = {
        //     "United States of America": "USA"
        // };

        // EDQ.showFields = function(hideInput) {
        //     hideInput = hideInput || false;

        //     if (hideInput) {
        //         EDQ.resultscontainer.prev('input').hide();
        //         EDQ.resultscontainer.prev('input').prev('label').hide();
        //     }

        //     EDQ.resultscontainer.prev('input').each(function() {
        //         $.each(this.attributes, function(i, attrib) {
        //             var name = attrib.name;
        //             var value = attrib.value;
        //             if (name == "data-map-address" || name == "data-map-suburb" || name == "data-map-state" || name == "data-map-postcode") {
        //                 $('#customField' + value).parents('.custom-form').show();
        //             }
        //         });
        //     });
        // }

        // EDQ.selectResult = function(i, scroll) {
        //     $('.address-results li').removeClass('active');
        //     $('.address-results li').eq(i).addClass('active');
        //     if (scroll) {
        //         EDQ.scrollResult();
        //     }
        // }

        // EDQ.scrollResult = function() {

        //         var resultT = $('.address-results:visible').offset().top;
        //         var resultH = $('.address-results:visible').height();
        //         var resultS = $('.address-results:visible').scrollTop();

        //         var activeT = $('.address-results:visible li.active').offset().top;
        //         var activeH = $('.address-results:visible li.active').height();

        //         if (activeT < resultT) {
        //             var dif = resultT - activeT - activeH;
        //             $('.address-results:visible').scrollTop(dif);
        //         } else if (((activeT + resultS) + activeH) > (resultT + resultH)) {
        //             var dif = resultS + activeT + activeH - resultH - resultT;
        //             $('.address-results:visible').scrollTop(dif);
        //         }
        //     }
        /*
        $(document).on('focus input', '.address-search-container input', function() {
            var value = $(this).val();
            var length = value.length;
            EDQ.resultscontainer = $(this).parents('.address-search-container').find('.address-results-container');
            EDQ.results = EDQ.resultscontainer.find('.address-results');
            EDQ.country = EDQ.enabledCountries[0]; //$('select[id$="_dd_Country"]').val();
            EDQ.term = value;

            var field = $(this);
            var address = $(this).attr('data-map-address');
            var suburb = $(this).attr('data-map-suburb');
            var state = $(this).attr('data-map-state');
            var postcode = $(this).attr('data-map-postcode');



            if (length >= 4) {
                EDQ.client.search(value, EDQ.countries[EDQ.country]).done(function(results) {
                    EDQ.results.empty();
                    EDQ.resultscontainer.find('.helper').show();
                    $.each(results.picklist.slice(0, EDQ.limit), function(i, v) {
                        var active = (i == 0) ? "active" : "";
                        EDQ.resultscontainer.show();
                        EDQ.resultscontainer.find('.helper').show();
                        EDQ.results.append($('<li class="address-result ' + active + '" id="address-result-' + i + '"><a data-moniker="' + v.moniker + '" >' + v.picklist + '</a></li>'));
                    });
                    EDQ.length = (results.picklist.length >= EDQ.limit) ? EDQ.limit : results.picklist.length;
                    EDQ.results.css('max-height', function() {
                        return EDQ.show * EDQ.results.find('li').first().height() + 'px';
                    });

                    $('a[data-moniker]').off('click').on('click', function() {
                        EDQ.term = $(this).text();
                        EDQ.client.format($(this).attr('data-moniker'), EDQ.countries[EDQ.country], 'IntuitiveDefault').done(function(result) {
                            $('#customField' + address).val(function() {
                                var value = result.address.addressLine1;
                                if (result.address.addressLine2.length) {
                                    value += ", " + result.address.addressLine2
                                };
                                if (result.address.addressLine3.length) {
                                    value += ", " + result.address.addressLine3
                                };
                                return value;
                            }).trigger('change');

                            $('#customField' + suburb).val(result.address.locality).trigger('change');
                            $('#customField' + postcode).val(result.address.postalCode).trigger('change');
                            $('#customField' + state + ' option:contains("' + result.address.province + '")').prop('selected', true).trigger('change');
                            field.val(EDQ.term);
                            //EDQ.showFields(false);
                        });
                    });
                });
            }
        });

        $(document).on('hover', '.address-search-container .address-results .address-result', function() {
            EDQ.current = $(this).attr('id').split("-")[2];
            EDQ.selectResult(EDQ.current, false);
        });
        $(document).on('keydown', '.address-search-container input', function(e) {
            switch (e.keyCode) {
                case 38: //up
                    if (EDQ.current > 0) {
                        EDQ.current--;
                        EDQ.selectResult(EDQ.current, true);
                    }
                    break;
                case 40: //down
                    if (EDQ.current < (EDQ.length - 1)) {
                        EDQ.current++;
                        EDQ.selectResult(EDQ.current, true);
                    }
                    break;
                case 13: //enter
                    $(this).parents('.address-search-container').find('.address-results .address-result.active a').click();
                    e.preventDefault();
                    return false;
                    break;
                case 9: //tab
                    $(this).parents('.address-search-container').find('.address-results .address-result.active a').click();
                    break;
                default: //other
                    return true;
            }

        });
	  */

      /*
        $("body").click(function(e) {
            if (!$(e.target).is('.address-search-container') && EDQ.results.length && !$(e.target).is('.address_search')) {
                EDQ.resultscontainer.find('.helper').hide();
                EDQ.results.empty();
            }
        });

        $(document).on('click', 'span.helper a', function() {
            EDQ.resultscontainer = $(this).parents('.address-results-container');
            if (!EDQ.resultscontainer.prev('input[data-map-address]').length) {
                EDQ.resultscontainer.prev('input[data-map-address]').removeClass('address_search').removeAttr('data-map-address, data-map-suburb, data-map-state, data-map-postcode').show();
                EDQ.resultscontainer.remove();
            } else {
                EDQ.showFields(true);
            }
        });

        Sys.Application.add_load(function() {
            EDQ.country = EDQ.enabledCountries[0]; //$('select[id$="_dd_Country"]').val();

            if (jQuery.inArray(EDQ.country, EDQ.enabledCountries) < 0) {
                // already has an address in the field
                EDQ.showFields(true);
            } else {
                EDQ.results = $('.address-search-container:not(.template) .address-results');
                EDQ.resultscontainer = $('.address-search-container:not(.template) .address-results-container');
                EDQ.resultscontainer.find('.helper').hide();
            }
        });
		*/

        $(document).on('change input blur', '#InteractionAdd input, #InteractionAdd select', function() {
            $(this).valid();
        });

    }
    Sys.Application.add_load(function() {
        $('#btnSubmitProxy').attr('onclick', 'BBCustomFormSubmit();');
    });



    // add custom validator for phone numbers
    $.validator.addMethod("phone", function(phone_number, element) {
        var digits = "0123456789";
        var phoneNumberDelimiters = "()- ext.";
        var validWorldPhoneChars = phoneNumberDelimiters + "+";
        var minDigitsInIPhoneNumber = 10;
        s = stripCharsInBag(phone_number, validWorldPhoneChars);
        return this.optional(element) || isInteger(s) && s.length >= minDigitsInIPhoneNumber;
    }, "Please enter a valid phone number.");

    function isInteger(s) {
        var i;
        for (i = 0; i < s.length; i++) {
            // Check that current character is number.
            var c = s.charAt(i);
            if (((c < "0") || (c > "9"))) return false;
        } // All characters are numbers.
        return true;
    }

    function stripCharsInBag(s, bag) {
        var i;
        var returnString = "";
        // Search through string's characters one by one.
        // If character is not in bag, append to returnString.
        for (i = 0; i < s.length; i++) {
            // Check that current character isn't whitespace.
            var c = s.charAt(i);
            if (bag.indexOf(c) == -1) returnString += c;
        }
        return returnString;
    }

    function BBCustomFormSubmit() {

        if (jQuery.isFunction(jQuery.validator)) {
            var valid = $('#form1').validate({
                ignore: ":not(:visible)"
            }).form();

            if (valid || $("#form1").validate().errorList.length == 0) {
                var text = "";
                $('.custom-form').not('.hide, .hideMatrix').each(function() {
                    var label = $(this).children('label').not('.error').text().trim();
                    var heading = $(this).find('h2').text().trim();
                    if (!heading.length) {
                        var value = "";
                        if ($(this).find('.form-check').length > 0) {
                            var list = "";
                            $(this).find('.form-check').each(function() {

                                if ($(this).find('input[type="checkbox"]').is(':checked')) {
                                    list += $(this).find('label span').text() + ", ";
                                }
                            });
                            value = list.substring(0, list.length - 2);
                        } else if ($(this).find('input[type="checkbox"]').length) {
                            value = $(this).find('input[type="checkbox"]').is(':checked') ? "Yes" : "No";
                        } else if ($(this).find('select').length) {
                            value = $(this).find('select option:selected').text();
                        } else if ($(this).find('input').length) {
                            value = $(this).find('input').val();
                        }
                        if (value.length) {
                            text += label + "\n";
                            text += value + "\n\n";
                        }
                    } else {
                        text += "===" + heading + "===" + "\n\n"
                    }

                });
                $('div[id$="_divComment"] textarea').val(text);

                IAFSubmit();
            }
        }

    }

    function RunMatrix(EventCategoryID, Data) {
        $.each(Data[EventCategoryID], function(key, value) {
            if (!value) {
                $('#customField' + key).parents('.custom-form').addClass('hideMatrix');
            } else {
                $('#customField' + key).parents('.custom-form').removeClass('hideMatrix');
            }
        });
    }

    $(document).on('blur', '#InteractionAdd input[type=date], #InteractionAdd input[type=time]', function() {
        $(this).valid();
    });

    //TEMP NEED TO REMOVE LATER
    function IAFSubmit() {
        $('#InteractionAdd .form-wrap input').click();
    }
</script>
